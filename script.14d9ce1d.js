parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"mdTS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.REDMI_URL=void 0;const e="https://gist.githubusercontent.com/Ruz-len/edb6d683f4419a160dfbc148eb4f5c09/raw/08efc79916914bc52313df8800080c9318ce392e/redmi.json";exports.REDMI_URL=e;
},{}],"MnvL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DataApi=void 0;var t=require("../constants/api");class e{async getData(t){const e=await fetch(t);if(!e.ok)throw new Error("fetch failed");return await e.json()}async getRedmiProducts(){return await this.getData(t.REDMI_URL)}}exports.DataApi=e;
},{"../constants/api":"mdTS"}],"lKpD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CART_ELEMENT=exports.HEADER_ELEMENT=exports.PRODUCTS_ELEMENT=void 0;const e=document.querySelector(".products");exports.PRODUCTS_ELEMENT=e;const t=document.querySelector(".header");exports.HEADER_ELEMENT=t;const E=document.querySelector(".cart");exports.CART_ELEMENT=E;
},{}],"FRKU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n=require("../constants/roots");class e{listener({onOpenCart:e}){n.HEADER_ELEMENT.querySelector(".cart-btn").addEventListener("click",e)}render({favoriteCounter:e,cartCounter:t,...a}){n.HEADER_ELEMENT.innerHTML=`\n            <div class="header__container container"> \n                <nav class="navigation">\n                    <ul class="navigation__list">\n                        <li class="nagigation__item">\n                            <a href="./public/index.html" class="navigation__link">Все товары</a>\n                        </li>\n                    </ul>\n                </nav>\n\n                <button class="cart-btn icon-cart">${t}</button>\n\n                <div class="favorite">\n                    <a href="#" class="favorite__link icon-heart">${e}</a>\n                </div>\n            </div>\n        `,this.listener(a)}}var t=new e;exports.default=t;
},{"../constants/roots":"lKpD"}],"aHwQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=require("../constants/roots");class r{listener({onFavorite:r,onCart:t}){e.PRODUCTS_ELEMENT.querySelectorAll(".card__heart").forEach(e=>{e.addEventListener("click",r)}),e.PRODUCTS_ELEMENT.querySelectorAll(".card__btn").forEach(e=>{e.addEventListener("click",t)})}render({products:r,...t}){r.length?(e.PRODUCTS_ELEMENT.innerHTML=r.map(e=>{const r=e.isFavorite?"_active":"",t=e.isCart?"Удалить":"Добавить";return`\n                <li class="products__item card">\n                    <div class="card__header">\n                        <img src="${e.image}" alt="" class="card__img">\n                    </div>\n                    <div class="card__body">\n                        <h3 class="card__name">${e.name}</h3>\n                    </div>\n                    <div class="card__footer">\n                        <div class="card__price">${e.price.toLocaleString()} ₽</div>\n                        <button class="card__btn" data-id="${e.id}">${t}</button>\n                    </div>\n                    <button class="card__heart ${r}" data-id="${e.id}"></button>\n                </li>\n            `}).join(""),this.listener(t)):e.PRODUCTS_ELEMENT.innerHTML="Nothing.."}}var t=new r;exports.default=t;
},{"../constants/roots":"lKpD"}],"jSPH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=require("../constants/roots");class e{listener(){t.CART_ELEMENT.querySelector(".cart__close").addEventListener("click",this.hide)}show(){t.CART_ELEMENT.classList.add("_active")}hide(){t.CART_ELEMENT.classList.remove("_active")}renderProducts(t){return t.map(({image:t,name:e,price:s})=>`\n                    <li class="cart__product">\n                        <img src="${t}" alt="">\n                        <div>\n                            <h3>${e}</h3>\n                            <span>${s.toLocaleString()} ₽</span>\n                        </div>\n                    </li>\n                `).join("")}render({cartProducts:e}){const s=this.renderProducts(e).trim()||"Cart is empty...",r=e.reduce((t,e)=>t+e.price,0);t.CART_ELEMENT.innerHTML=`\n            <div class="cart__dialog">\n                <h2 class="cart__title">Корзина</h2>\n                <ul class="cart__products">${s}</ul>\n                <div class="cart__total-cost">\n                    <b>Общая стоимость:</b>\n                    <span>${r.toLocaleString()} ₽</span>\n                </div>\n                <button class="cart__close">&times;</button>\n            </div>  \n            `,this.listener()}}var s=new e;exports.default=s;
},{"../constants/roots":"lKpD"}],"wF8h":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=require("../services/DataApi"),e=s(require("./Header")),r=s(require("./Products")),a=s(require("./Cart"));function s(t){return t&&t.__esModule?t:{default:t}}const i=new t.DataApi;class o{constructor(){this.state={products:[],favorite:JSON.parse(localStorage.getItem("favorite"))||[],cart:JSON.parse(localStorage.getItem("cart"))||[]}}setState(t){this.state={...this.state,...t},this.render()}async init(){this.render();const t=await i.getRedmiProducts();this.setState({products:t,loading:!1})}transformProducts(t){return this.state.products.map(t=>(-1!==this.state.favorite.indexOf(t.id)?t.isFavorite=!0:t.isFavorite=!1,-1!==this.state.cart.indexOf(t.id)?t.isCart=!0:t.isCart=!1,t))}filterCart(t){return t.filter(t=>-1!==this.state.cart.indexOf(t.id))}onFavorite(t){const e=t.target.getAttribute("data-id"),r=this.state.favorite.indexOf(e);-1===r?this.state.favorite.push(e):this.state.favorite.splice(r,1),localStorage.setItem("favorite",JSON.stringify(this.state.favorite)),this.render()}onCart(t){const e=t.target.getAttribute("data-id"),r=this.state.cart.indexOf(e);-1===r?this.state.cart.push(e):this.state.cart.splice(r,1),localStorage.setItem("cart",JSON.stringify(this.state.cart)),this.render()}onOpenCart(){a.default.show()}render(){const t=this.onFavorite.bind(this),s=this.onCart.bind(this),i=this.transformProducts(),o=this.state.favorite.length,n=this.state.cart.length,d=this.onOpenCart.bind(this),c=this.filterCart(i);e.default.render({favoriteCounter:o,cartCounter:n,onOpenCart:d}),r.default.render({products:i,onFavorite:t,onCart:s}),a.default.render({cartProducts:c})}}var n=new o;exports.default=n;
},{"../services/DataApi":"MnvL","./Header":"FRKU","./Products":"aHwQ","./Cart":"jSPH"}],"QjzR":[function(require,module,exports) {
"use strict";var e=t(require("./components/App"));function t(e){return e&&e.__esModule?e:{default:e}}document.addEventListener("DOMContentLoaded",e.default.init());
},{"./components/App":"wF8h"}]},{},["QjzR"], null)
//# sourceMappingURL=/script.14d9ce1d.js.map