{"version":3,"sources":["../src/constants/api.js","../src/services/DataApi.js","../src/constants/roots.js","../src/components/Header.js","../src/components/Products.js","../src/components/Cart.js","../src/components/App.js","../src/script.js"],"names":["REDMI_URL","DataApi","getData","url","body","fetch","ok","Error","json","getRedmiProducts","PRODUCTS_ELEMENT","document","querySelector","HEADER_ELEMENT","CART_ELEMENT","Header","listener","onOpenCart","addEventListener","render","favoriteCounter","cartCounter","cb","innerHTML","Products","onFavorite","onCart","querySelectorAll","forEach","btn","products","length","map","item","activeClass","isFavorite","cartLabel","isCart","image","name","price","toLocaleString","id","join","Cart","hide","show","classList","add","remove","renderProducts","cartProducts","itemsCart","trim","totalCost","reduce","p","c","dataApi","App","constructor","state","favorite","JSON","parse","localStorage","getItem","cart","setState","init","loading","transformProducts","arr","indexOf","filterCart","filter","e","target","getAttribute","index","push","splice","setItem","stringify","bind"],"mappings":"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","file":"script.14d9ce1d.js","sourceRoot":"..\\public","sourcesContent":["const REDMI_URL = 'https://gist.githubusercontent.com/Ruz-len/edb6d683f4419a160dfbc148eb4f5c09/raw/08efc79916914bc52313df8800080c9318ce392e/redmi.json';\r\n\r\nexport {\r\n    REDMI_URL\r\n};","import { REDMI_URL } from '../constants/api';\r\n\r\nclass DataApi {\r\n    async getData(url) {\r\n        const body = await fetch(url);\r\n        if (!body.ok) throw new Error('fetch failed');\r\n        return await body.json();\r\n    }\r\n\r\n    async getRedmiProducts() {\r\n        return await this.getData(REDMI_URL);\r\n    }\r\n}\r\n\r\nexport { DataApi };","const PRODUCTS_ELEMENT = document.querySelector('.products');\r\nconst HEADER_ELEMENT = document.querySelector('.header');\r\nconst CART_ELEMENT = document.querySelector('.cart');\r\n\r\nexport {\r\n    PRODUCTS_ELEMENT,\r\n    HEADER_ELEMENT,\r\n    CART_ELEMENT \r\n};","import { HEADER_ELEMENT } from '../constants/roots';\r\n\r\nclass Header {\r\n    listener({ onOpenCart }) {\r\n        const cartBtn = HEADER_ELEMENT.querySelector('.cart-btn');\r\n        cartBtn.addEventListener('click', onOpenCart);\r\n    }\r\n\r\n    render({ favoriteCounter, cartCounter, ...cb }) {\r\n        HEADER_ELEMENT.innerHTML = (`\r\n            <div class=\"header__container container\"> \r\n                <nav class=\"navigation\">\r\n                    <ul class=\"navigation__list\">\r\n                        <li class=\"nagigation__item\">\r\n                            <a href=\"./public/index.html\" class=\"navigation__link\">Все товары</a>\r\n                        </li>\r\n                    </ul>\r\n                </nav>\r\n\r\n                <button class=\"cart-btn icon-cart\">${cartCounter}</button>\r\n\r\n                <div class=\"favorite\">\r\n                    <a href=\"#\" class=\"favorite__link icon-heart\">${favoriteCounter}</a>\r\n                </div>\r\n            </div>\r\n        `);\r\n\r\n        this.listener(cb);\r\n    }\r\n}\r\n\r\nexport default new Header;","import { PRODUCTS_ELEMENT } from '../constants/roots';\r\n\r\nclass Products {\r\n    listener({ onFavorite, onCart }) {\r\n        PRODUCTS_ELEMENT.querySelectorAll('.card__heart').forEach(btn => {\r\n            btn.addEventListener('click', onFavorite);\r\n        });\r\n\r\n        PRODUCTS_ELEMENT.querySelectorAll('.card__btn').forEach(btn => {\r\n            btn.addEventListener('click', onCart);\r\n        });\r\n    }\r\n\r\n    render({ products, ...cb }) {\r\n        if (!products.length) {\r\n            PRODUCTS_ELEMENT.innerHTML = 'Nothing..'\r\n            return;\r\n        }\r\n\r\n        PRODUCTS_ELEMENT.innerHTML = products.map(item => {\r\n            const activeClass = item.isFavorite ? '_active' : '';\r\n            const cartLabel = item.isCart ? 'Удалить' : 'Добавить';\r\n\r\n            return (`\r\n                <li class=\"products__item card\">\r\n                    <div class=\"card__header\">\r\n                        <img src=\"${item.image}\" alt=\"\" class=\"card__img\">\r\n                    </div>\r\n                    <div class=\"card__body\">\r\n                        <h3 class=\"card__name\">${item.name}</h3>\r\n                    </div>\r\n                    <div class=\"card__footer\">\r\n                        <div class=\"card__price\">${item.price.toLocaleString()} ₽</div>\r\n                        <button class=\"card__btn\" data-id=\"${item.id}\">${cartLabel}</button>\r\n                    </div>\r\n                    <button class=\"card__heart ${activeClass}\" data-id=\"${item.id}\"></button>\r\n                </li>\r\n            `);\r\n\r\n        }).join('');\r\n        \r\n        this.listener(cb);\r\n    }\r\n}\r\n\r\nexport default new Products;","import { CART_ELEMENT } from '../constants/roots';\r\n\r\nclass Cart {\r\n    listener() {\r\n        const closeBtn = CART_ELEMENT.querySelector('.cart__close');\r\n        closeBtn.addEventListener('click', this.hide);\r\n    }\r\n\r\n    show() {\r\n        CART_ELEMENT.classList.add('_active');\r\n    }\r\n\r\n    hide() {\r\n        CART_ELEMENT.classList.remove('_active');\r\n    }\r\n\r\n    renderProducts(cartProducts) {\r\n        return cartProducts.map(({image, name, price}) => {\r\n            return (`\r\n                    <li class=\"cart__product\">\r\n                        <img src=\"${image}\" alt=\"\">\r\n                        <div>\r\n                            <h3>${name}</h3>\r\n                            <span>${price.toLocaleString()} ₽</span>\r\n                        </div>\r\n                    </li>\r\n                `);\r\n        }).join('');\r\n    }\r\n\r\n    render({ cartProducts }) {\r\n        const itemsCart = this.renderProducts(cartProducts).trim() || 'Cart is empty...';\r\n        const totalCost = cartProducts.reduce((p, c) => p + c.price, 0);\r\n\r\n        CART_ELEMENT.innerHTML = (`\r\n            <div class=\"cart__dialog\">\r\n                <h2 class=\"cart__title\">Корзина</h2>\r\n                <ul class=\"cart__products\">${itemsCart}</ul>\r\n                <div class=\"cart__total-cost\">\r\n                    <b>Общая стоимость:</b>\r\n                    <span>${totalCost.toLocaleString()} ₽</span>\r\n                </div>\r\n                <button class=\"cart__close\">&times;</button>\r\n            </div>  \r\n            `);\r\n\r\n        this.listener();\r\n    }\r\n}\r\n    \r\nexport default new Cart;","import { DataApi } from '../services/DataApi';\r\n\r\nimport Header from './Header';\r\n\r\nimport Products from './Products';\r\n\r\nimport Cart from './Cart';\r\n\r\nconst dataApi = new DataApi();\r\n\r\nclass App {\r\n    constructor() {\r\n        this.state = {\r\n            products: [],\r\n            favorite: JSON.parse(localStorage.getItem('favorite')) || [],\r\n            cart: JSON.parse(localStorage.getItem('cart')) || []\r\n        };\r\n    }\r\n\r\n    setState(state) {\r\n        this.state = {...this.state, ...state};\r\n        this.render();\r\n    }\r\n\r\n    async init() {\r\n        this.render();\r\n        const products = await dataApi.getRedmiProducts();\r\n        this.setState({\r\n            products,\r\n            loading: false\r\n        });\r\n    }\r\n\r\n    transformProducts(arr) {\r\n        return this.state.products.map(item => {\r\n            if (this.state.favorite.indexOf(item.id) !== -1) item.isFavorite = true;\r\n            else item.isFavorite = false;\r\n\r\n            if (this.state.cart.indexOf(item.id) !== -1) item.isCart = true;\r\n            else item.isCart = false;\r\n\r\n            return item;\r\n        });\r\n    }\r\n\r\n    filterCart(products) {\r\n        return products.filter(item => {\r\n            return this.state.cart.indexOf(item.id) !== -1;\r\n        });\r\n    }\r\n\r\n    onFavorite(e) {\r\n\r\n        const btn = e.target;\r\n        const id = btn.getAttribute('data-id');\r\n        const index = this.state.favorite.indexOf(id);\r\n\r\n        if (index === -1) this.state.favorite.push(id);\r\n        else this.state.favorite.splice(index, 1);\r\n\r\n        localStorage.setItem('favorite', JSON.stringify(this.state.favorite));\r\n\r\n        this.render();\r\n    }\r\n\r\n    onCart(e) {\r\n        const btn = e.target;\r\n        const id = btn.getAttribute('data-id');\r\n        const index = this.state.cart.indexOf(id);\r\n\r\n        if (index === -1) this.state.cart.push(id);\r\n        else this.state.cart.splice(index, 1);\r\n\r\n        localStorage.setItem('cart', JSON.stringify(this.state.cart));\r\n\r\n        this.render();\r\n    }\r\n\r\n    onOpenCart() {\r\n        Cart.show();\r\n    }\r\n\r\n    render() {\r\n        const onFavorite = this.onFavorite.bind(this);\r\n        const onCart = this.onCart.bind(this);\r\n        const products = this.transformProducts();\r\n\r\n        const favoriteCounter = this.state.favorite.length;\r\n        const cartCounter = this.state.cart.length;\r\n        const onOpenCart = this.onOpenCart.bind(this);\r\n\r\n        const cartProducts = this.filterCart(products);\r\n\r\n        Header.render({ favoriteCounter, cartCounter, onOpenCart });\r\n        Products.render({ products, onFavorite, onCart });\r\n        Cart.render({ cartProducts });\r\n    }\r\n}\r\n\r\nexport default new App;","import App from './components/App';\r\n\r\ndocument.addEventListener('DOMContentLoaded', App.init());"]}